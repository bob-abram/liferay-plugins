<?xml version="1.0"?>
<!DOCTYPE project>

<project name="build-common-theme">
	<import file="../build-common-plugin.xml" />

	<target name="build-css">
		<java
			classname="com.liferay.portal.tools.SassToCssBuilder"
			classpathref="portal.classpath"
			fork="true"
			newenvironment="true"
		>
			<jvmarg value="-Dliferay.lib.portal.dir=${app.server.lib.portal.dir}" />
			<arg value="sass.dir=/" />
			<arg value="sass.docroot.dir=${basedir}/docroot" />
			<arg value="sass.portal.common.dir=${app.server.portal.dir}/html/css/common" />
		</java>
	</target>

	<target name="war" depends="compile">
		<antcall target="build-css" />

		<if>
			<not>
				<available file="docroot/images/screenshot.png" />
			</not>
			<then>
				<echo>screenshot.png does not exist.</echo>
			</then>
		</if>

		<if>
			<not>
				<available file="docroot/images/thumbnail.png" />
			</not>
			<then>
				<echo>thumbnail.png does not exist.</echo>
			</then>
		</if>

		<mkdir dir="${sdk.dir}/dist" />

		<delete file="${plugin.file}" />

		<zip
			basedir="docroot"
			destfile="${plugin.file}"
			excludes="_diffs.*,_diffs/**,${plugins.war.excludes}"
		/>
	</target>
</project>